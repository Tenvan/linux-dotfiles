#!/usr/bin/env bash

export WORK_ONETIME=$WORKSPACE/Node/OneTime
export WORK_ONEMOBILE=$WORKSPACE/Node/OneMobile

ONETIME_SHELL="$TERMINAL --directory $WORK_ONETIME"
ONEMOBILE_SHELL="$TERMINAL --directory $WORK_ONEMOBILE"

startServer_OT() {
    $ONETIME_SHELL --hold --title OTC:StartServer yarn workspace onetime-server run start &
}

startCompiler_OT() {
    $ONETIME_SHELL --hold --title OTC:StartDefault yarn workspace onetime-client start &
}

startCompiler_OM() {
    $ONEMOBILE_SHELL --hold --title OMC:StartDefault yarn start &
}

startAll_OT() {
    killall node
    fuser -k 4200/tcp
    fuser -k 4201/tcp
    fuser -k 4202/tcp
    startServer
    startCompiler
}

export CUSTOM_TOP_ACTIONS=(
    "ğŸ—‚ OM: Dateien" "$FILEMANAGER $WORK_ONEMOBILE"
    "ğŸ’» OM: Shell" "$ONEMOBILE_SHELL --hold --title OTC:Shell"
    "ğŸ‡¬ OM: Git" "code $ONEMOBILE_SHELL"
    "ğŸ›« OM: Start Compiler" "startCompiler_OM"
    "ğŸ›« OM: Build Android" "$ONEMOBILE_SHELL --hold --title OMC:BuildAndroid $TIME yarn android:build"
    "ğŸ‡º OM: Check Updates" "$ONEMOBILE_SHELL --hold --title OMC:CheckUpdates $TIME yarn outdated"
)

export CUSTOM_BOTTOM_ACTIONS=(
    "ğŸ—‚ OT: Dateien" "$FILEMANAGER $WORK_ONEMOBILE"
    "ğŸ’» OT: Shell" "$ONETIME_SHELL --hold --title OTC:Shell"
    "ğŸ‡¬ OT: Git" "code $WORK_ONETIME"
    "ğŸ„ OT: Start Server" "startServer_OT"
    "ğŸ›« OT: Start Compiler" "startCompiler_OT"
    "ğŸ„ OT: Start All" "startAll_OT"
    "ğŸ‡¬ OT: Generate" "$ONETIME_SHELL --hold --title OTC:Generate $TIME yarn generate"
    "ğŸ‡© OT: Deploy Build" "$ONETIME_SHELL --hold --title OTC:DeployBuild yarn deploy_build"
    "ğŸ’‰ OT: Doctor" "$ONETIME_SHELL --hold --title OTC:Doctor $TIME yarn doctor"
    "ğŸ’‰ OT: Doctor Check" "$ONETIME_SHELL --hold --title OTC:DoctorCheck $TIME yarn doctor:check"
    "â˜‘ OT: Client Check" "$ONETIME_SHELL --hold --title OTC:ClientCheck $TIME yarn client:check"
    "âœ… OT: Prod Check" "$ONETIME_SHELL --hold --title OTC:ClientCheck $TIME yarn client:check:prod"
    "ğŸ‡º OT: Check Updates" "$ONETIME_SHELL --hold --title OTC:CheckClientUpdates $TIME yarn upgrade-interactive"
)

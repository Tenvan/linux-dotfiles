---
- name: "=====> set gtk2 settings <====="
  block:
    - name: set cursor theme
      ansible.builtin.replace:
        path: "{{ home_dir }}/.gtkrc-2.0"
        regexp: '^.*gtk-cursor-theme-name=.*$'
        replace: "gtk-cursor-theme-name={{ lookup('ansible.builtin.env', 'CURSOR_THEME') }}"

    - name: set cursor size
      ansible.builtin.replace:
        path: "{{ home_dir }}/.gtkrc-2.0"
        regexp: '^.*gtk-cursor-theme-size=.*$'
        replace: "gtk-cursor-theme-size={{ lookup('ansible.builtin.env', 'CURSOR_SIZE') }}"

    - name: set font
      ansible.builtin.replace:
        path: "{{ home_dir }}/.gtkrc-2.0"
        regexp: '^.*gtk-font-name=.*$'
        replace: "gtk-font-name=\"{{ lookup('ansible.builtin.env', 'THEME_FONT') }}\""

    - name: set icon theme
      ansible.builtin.replace:
        path: "{{ home_dir }}/.gtkrc-2.0"
        regexp: '^.*gtk-icon-theme-name=.*$'
        replace: "gtk-icon-theme-name=\"{{ lookup('ansible.builtin.env', 'ICON_THEME') }}\""

    - name: set sound theme
      ansible.builtin.replace:
        path: "{{ home_dir }}/.gtkrc-2.0"
        regexp: '^.*gtk-sound-theme-name=.*$'
        replace: "gtk-sound-theme-name={{ lookup('ansible.builtin.env', 'SOUND_THEME') }}"

    - name: set main theme
      ansible.builtin.replace:
        path: "{{ home_dir }}/.gtkrc-2.0"
        regexp: '^.*gtk-theme-name=.*$'
        replace: "gtk-theme-name={{ lookup('ansible.builtin.env', 'MAIN_THEME') }}"

- name: "=====> set gtk3 settings <====="
  block:
    - name: set cursor theme
      ansible.builtin.replace:
        path: "{{ home_dir }}/.config/gtk-3.0/settings.ini"
        regexp: '^.*gtk-cursor-theme-name=.*$'
        replace: "gtk-cursor-theme-name={{ lookup('ansible.builtin.env', 'CURSOR_THEME') }}"

    - name: set cursor size
      ansible.builtin.replace:
        path: "{{ home_dir }}/.config/gtk-3.0/settings.ini"
        regexp: '^.*gtk-cursor-theme-size=.*$'
        replace: "gtk-cursor-theme-size={{ lookup('ansible.builtin.env', 'CURSOR_SIZE') }}"

    - name: set font
      ansible.builtin.replace:
        path: "{{ home_dir }}/.config/gtk-3.0/settings.ini"
        regexp: '^.*gtk-font-name=.*$'
        replace: "gtk-font-name=\"{{ lookup('ansible.builtin.env', 'THEME_FONT') }}\""

    - name: set icon theme
      ansible.builtin.replace:
        path: "{{ home_dir }}/.config/gtk-3.0/settings.ini"
        regexp: '^.*gtk-icon-theme-name=.*$'
        replace: "gtk-icon-theme-name={{ lookup('ansible.builtin.env', 'ICON_THEME') }}"

    - name: set sound theme
      ansible.builtin.replace:
        path: "{{ home_dir }}/.config/gtk-3.0/settings.ini"
        regexp: '^.*gtk-sound-theme-name=.*$'
        replace: "gtk-sound-theme-name={{ lookup('ansible.builtin.env', 'SOUND_THEME') }}"

    - name: set main theme
      ansible.builtin.replace:
        path: "{{ home_dir }}/.config/gtk-3.0/settings.ini"
        regexp: '^.*gtk-theme-name=.*$'
        replace: "gtk-theme-name={{ lookup('ansible.builtin.env', 'MAIN_THEME') }}"

- name: "=====> set gtk4 settings <====="
  block:
    - name: set cursor theme
      ansible.builtin.replace:
        path: "{{ home_dir }}/.config/gtk-4.0/settings.ini"
        regexp: '^.*gtk-cursor-theme-name=.*$'
        replace: "gtk-cursor-theme-name={{ lookup('ansible.builtin.env', 'CURSOR_THEME') }}"

    - name: set cursor size
      ansible.builtin.replace:
        path: "{{ home_dir }}/.config/gtk-4.0/settings.ini"
        regexp: '^.*gtk-cursor-theme-size=.*$'
        replace: "gtk-cursor-theme-size={{ lookup('ansible.builtin.env', 'CURSOR_SIZE') }}"

    - name: set font
      ansible.builtin.replace:
        path: "{{ home_dir }}/.config/gtk-4.0/settings.ini"
        regexp: '^.*gtk-font-name=.*$'
        replace: "gtk-font-name={{ lookup('ansible.builtin.env', 'THEME_FONT') }}"

    - name: set icon theme
      ansible.builtin.replace:
        path: "{{ home_dir }}/.config/gtk-4.0/settings.ini"
        regexp: '^.*gtk-icon-theme-name=.*$'
        replace: "gtk-icon-theme-name={{ lookup('ansible.builtin.env', 'ICON_THEME') }}"

    - name: set sound theme
      ansible.builtin.replace:
        path: "{{ home_dir }}/.config/gtk-4.0/settings.ini"
        regexp: '^.*gtk-sound-theme-name=.*$'
        replace: "gtk-sound-theme-name={{ lookup('ansible.builtin.env', 'SOUND_THEME') }}"

    - name: set main theme
      ansible.builtin.replace:
        path: "{{ home_dir }}/.config/gtk-4.0/settings.ini"
        regexp: '^.*gtk-theme-name=.*$'
        replace: "gtk-theme-name={{ lookup('ansible.builtin.env', 'MAIN_THEME') }}"

- name: "=====> set qt5 settings <====="
  block:
    - name: set icon theme
      ansible.builtin.replace:
        path: "{{ home_dir }}/.config/qt5ct/qt5ct.conf"
        regexp: '^.*icon_theme=.*$'
        replace: "icon_theme={{ lookup('ansible.builtin.env', 'ICON_THEME') }}"

    - name: set dialogs
      ansible.builtin.replace:
        path: "{{ home_dir }}/.config/qt5ct/qt5ct.conf"
        regexp: '^.*standard_dialogs=.*$'
        replace: "standard_dialogs=gtk3"

    - name: set style
      ansible.builtin.replace:
        path: "{{ home_dir }}/.config/qt5ct/qt5ct.conf"
        regexp: '^.*style=.*$'
        replace: "style=Adwaita-Dark"

    - name: set palette
      ansible.builtin.replace:
        path: "{{ home_dir }}/.config/qt5ct/qt5ct.conf"
        regexp: '^.*custom_palette=.*$'
        replace: "custom_palette=false"

- name: "=====> set qt6 settings <====="
  block:
    - name: set icon theme
      ansible.builtin.replace:
        path: "{{ home_dir }}/.config/qt6ct/qt6ct.conf"
        regexp: '^.*icon_theme=.*$'
        replace: "icon_theme={{ lookup('ansible.builtin.env', 'ICON_THEME') }}"

    - name: set dialogs
      ansible.builtin.replace:
        path: "{{ home_dir }}/.config/qt6ct/qt6ct.conf"
        regexp: '^.*standard_dialogs=.*$'
        replace: "standard_dialogs=gtk3"

    - name: set style
      ansible.builtin.replace:
        path: "{{ home_dir }}/.config/qt6ct/qt6ct.conf"
        regexp: '^.*style=.*$'
        replace: "style=Adwaita-Dark"

    - name: set palette
      ansible.builtin.replace:
        path: "{{ home_dir }}/.config/qt6ct/qt6ct.conf"
        regexp: '^.*custom_palette=.*$'
        replace: "custom_palette=false"

- name: set themes for flatpak
  become: true
  block:
    - name: set theme folder
      shell: "flatpak override --filesystem={{ home_dir }}/.themes"
    - name: set theme
      shell: "sudo flatpak override --env=GTK_THEME={{ lookup('ansible.builtin.env', 'MAIN_THEME') }}"

- name: Synchronization themes with root home
  become: true
  block:
    - name: copy gtk2
      ansible.posix.synchronize:
        src: "{{ home_dir }}/.gtkrc-2.0"
        dest: "/root"
    - name: copy gtk3
      ansible.posix.synchronize:
        src: "{{ home_dir }}/.config/gtk-3.0"
        dest: "/root/.config"
    - name: copy gtk4
      ansible.posix.synchronize:
        src: "{{ home_dir }}/.config/gtk-4.0"
        dest: "/root/.config"

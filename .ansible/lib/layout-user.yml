---
- name: "=====> merge gtk-2.0 settings <====="
  block:
    - name: Remove old settings file
      ansible.builtin.file:
        path: "{{ home_dir }}/.gtkrc-2.0"
        state: absent

    - name: create new xettings file
      ansible.builtin.blockinfile:
        path: "{{ home_dir }}/.gtkrc-2.0"
        create: true
        block: |
          gtk-button-images=1
          gtk-cursor-theme-name="{{ lookup('ansible.builtin.env', 'CURSOR_THEME') }}"
          gtk-cursor-theme-size="{{ lookup('ansible.builtin.env', 'CURSOR_SIZE') }}"
          gtk-enable-event-sounds=1
          gtk-enable-input-feedback-sounds=1
          gtk-font-name="{{ lookup('ansible.builtin.env', 'THEME_FONT') }}"
          gtk-icon-theme-name="{{ lookup('ansible.builtin.env', 'ICON_THEME') }}"
          gtk-menu-images=0
          gtk-modules=canberra-gtk-module
          gtk-sound-theme-name="{{ lookup('ansible.builtin.env', 'SOUND_THEME') }}"
          gtk-theme-name="{{ lookup('ansible.builtin.env', 'MAIN_THEME') }}"
          gtk-toolbar-icon-size=GTK_ICON_SIZE_SMALL_TOOLBAR
          gtk-toolbar-style=GTK_TOOLBAR_ICONS
          gtk-xft-antialias=1
          gtk-xft-hinting=1
          gtk-xft-hintstyle=hintfull
          gtk-xft-rgba=rgb

- name: "=====> merge gtk-3.0 settings <====="
  block:
    - name: Remove old settings file
      ansible.builtin.file:
        path: "{{ home_dir }}/.config/gtk-3.0/settings.ini"
        state: absent

    - name: create new xettings file
      ansible.builtin.blockinfile:
        path: "{{ home_dir }}/.config/gtk-3.0/settings.ini"
        create: true
        block: |
          [Settings]
          gtk-application-prefer-dark-theme=true
          gtk-button-images=1
          gtk-cursor-theme-name={{ lookup('ansible.builtin.env', 'CURSOR_THEME') }}
          gtk-cursor-theme-size={{ lookup('ansible.builtin.env', 'CURSOR_SIZE') }}
          gtk-decoration-layout=icon:minimize,maximize,close
          gtk-enable-animations=true
          gtk-enable-event-sounds=1
          gtk-enable-input-feedback-sounds=1
          gtk-font-name="{{ lookup('ansible.builtin.env', 'THEME_FONT') }}"
          gtk-icon-theme-name={{ lookup('ansible.builtin.env', 'ICON_THEME') }}
          gtk-menu-images=0
          gtk-modules=canberra-gtk-module
          gtk-primary-button-warps-slider=false
          gtk-sound-theme-name={{ lookup('ansible.builtin.env', 'SOUND_THEME') }}
          gtk-theme-name={{ lookup('ansible.builtin.env', 'MAIN_THEME') }}
          gtk-toolbar-icon-size=GTK_ICON_SIZE_SMALL_TOOLBAR
          gtk-toolbar-style=GTK_TOOLBAR_ICONS
          gtk-xft-antialias=1
          gtk-xft-hinting=1
          gtk-xft-hintstyle=hintfull
          gtk-xft-rgba=rgb

- name: "=====> merge gtk-4.0 settings <====="
  block:
    - name: Remove old settings file
      ansible.builtin.file:
        path: "{{ home_dir }}/.config/gtk-4.0/settings.ini"
        state: absent

    - name: create new xettings file
      ansible.builtin.blockinfile:
        path: "{{ home_dir }}/.config/gtk-4.0/settings.ini"
        create: true
        block: |
          [Settings]
          gtk-application-prefer-dark-theme=true
          gtk-button-images=1
          gtk-cursor-theme-name={{ lookup('ansible.builtin.env', 'CURSOR_THEME') }}
          gtk-cursor-theme-size={{ lookup('ansible.builtin.env', 'CURSOR_SIZE') }}
          gtk-decoration-layout=icon:minimize,maximize,close
          gtk-enable-animations=true
          gtk-enable-event-sounds=1
          gtk-enable-input-feedback-sounds=1
          gtk-font-name="{{ lookup('ansible.builtin.env', 'THEME_FONT') }}"
          gtk-icon-theme-name={{ lookup('ansible.builtin.env', 'ICON_THEME') }}
          gtk-menu-images=0
          gtk-modules=canberra-gtk-module
          gtk-primary-button-warps-slider=false
          gtk-sound-theme-name={{ lookup('ansible.builtin.env', 'SOUND_THEME') }}
          gtk-theme-name={{ lookup('ansible.builtin.env', 'MAIN_THEME') }}
          gtk-toolbar-icon-size=GTK_ICON_SIZE_SMALL_TOOLBAR
          gtk-toolbar-style=GTK_TOOLBAR_ICONS
          gtk-xft-antialias=1
          gtk-xft-hinting=1
          gtk-xft-hintstyle=hintfull
          gtk-xft-rgba=rgb

- name: "=====> merge qt5 settings <====="
  block:
    - name: Remove old settings file
      ansible.builtin.file:
        path: "{{ home_dir }}/.config/qt5ct/qt5ct.conf"
        state: absent

    - name: create new xettings file
      ansible.builtin.blockinfile:
        path: "{{ home_dir }}/.config/qt5ct/qt5ct.conf"
        create: true
        block: |
          [Appearance]
          color_scheme_path=/usr/share/qt5ct/colors/airy.conf
          custom_palette=false
          icon_theme={{ lookup('ansible.builtin.env', 'ICON_THEME') }}
          standard_dialogs=gtk3
          style=Adwaita-Dark
          
          [Interface]
          activate_item_on_single_click=1
          buttonbox_layout=0
          cursor_flash_time=1000
          dialog_buttons_have_icons=1
          double_click_interval=400
          gui_effects=@Invalid()
          keyboard_scheme=2
          menus_have_icons=true
          show_shortcuts_in_context_menus=true
          stylesheets=/usr/share/qt5ct/qss/fusion-fixes.qss, /usr/share/qt5ct/qss/scrollbar-simple.qss, /usr/share/qt5ct/qss/sliders-simple.qss, /usr/share/qt5ct/qss/tooltip-simple.qss, /usr/share/qt5ct/qss/traynotification-simple.qss
          toolbutton_style=4
          underline_shortcut=1
          wheel_scroll_lines=3              

- name: set themes for flatpak
  become: true
  block:
    - name: set theme folder
      shell: "flatpak override --filesystem={{ home_dir }}/.themes"
    - name: set theme
      shell: "sudo flatpak override --env=GTK_THEME={{ lookup('ansible.builtin.env', 'MAIN_THEME') }}"

- name: Synchronization themes with root home
  become: true
  block:
    - name: copy gtk2
      ansible.posix.synchronize:
        src: "{{ home_dir }}/.gtkrc-2.0"
        dest: "/root"
    - name: copy gtk3
      ansible.posix.synchronize:
        src: "{{ home_dir }}/.config/gtk-3.0"
        dest: "/root/.config"
    - name: copy gtk4
      ansible.posix.synchronize:
        src: "{{ home_dir }}/.config/gtk-4.0"
        dest: "/root/.config"
